\documentclass[11pt]{article}

% Figures
\usepackage{graphicx}
\usepackage[list=true]{subcaption}
\graphicspath{{../../plots/}{../../tikz/}{../../img/}}
\usepackage[section]{placeins} % require floats to appear in the section they are defined

% fonts and appearance
\usepackage{amsmath, amsfonts, physics, siunitx, nicefrac}
\usepackage[american]{babel} 
\usepackage[T1]{fontenc} % improved font encoding
\usepackage[ttscale=0.8]{libertine}
\usepackage{fontawesome5}
\usepackage[format=plain, textfont=it]{caption}

% page size and margins
\usepackage{geometry}
\geometry{letterpaper,top=1in, bottom=1in, left=1in, right=2in}

% footer
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage[en-US]{datetime2}
\fancyhf{}
\fancyhead[L]{CONFIDENTIAL DRAFT by J. Doss-Gollin \& K. Keller}
\fancyhead[R]{\DTMnow}
\fancyfoot[R]{page~\thepage~of~\pageref{LastPage}}
\pagestyle{fancy}
\setlength{\headheight}{15pt}

% TO DO NOTES
\usepackage{xcolor} % list of colors at https://en.wikibooks.org/wiki/LaTeX/Colors
\definecolor{giallo}{HTML}{F0BC42} % https://teamcolorcodes.com/a-s-roma-color-codes/
\definecolor{rosso}{HTML}{8E1F2F}
\definecolor{grigio}{HTML}{CACACC}
\definecolor{nero}{HTML}{000000}
\usepackage[textsize=scriptsize]{todonotes}
\setlength{\marginparwidth}{1.5in}
\newcommand{\james}[1]{\todo[color=giallo, textcolor=nero]{\textbf{ATTN James:~}#1}} % if desired create a custom command for each author
\newcommand{\klaus}[1]{\todo[color=rosso, textcolor=grigio]{\textbf{ATTN Klaus:~}#1}}

% better tables
\usepackage{booktabs}
\usepackage{array}
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}

% better lists
\usepackage[inline]{enumitem}
\setlist{nosep}

% authors
\usepackage{authblk}
\title{A subjective Bayesian framework for synthesizing deep uncertainties in climate risk management}
\author[1]{James Doss-Gollin}
\author[2]{Klaus Keller}
\affil[1]{Department of Civil and Environmental Engineering, Rice University}
\affil[2]{Thayer School of Engineering, Dartmouth College}
\renewcommand*{\Affilfont}{\normalsize\normalfont}

% ACRONYMS
\usepackage[acronym, nopostdot, nonumberlist, shortcuts, numberedsection, nogroupskip,]{glossaries}
\newacronym{bfe}{BFE}{base flood elevation}
\newacronym{cmip}{CMIP}{the Coupled Model Intercomparison Project}
\newacronym{dmdu}{DMDU}{decision making under deep uncertainty}
\newacronym{fema}{FEMA}{the Federal Emergency Management Agency}
\newacronym{gev}{GEV}{generalized extreme value}
\newacronym{iid}{IID}{independent and identically distributed}
\newacronym{ipcc}{IPCC}{International Panel on Climate Change}
\newacronym{msl}{MSL}{mean relative sea level}
\newacronym{noaa}{NOAA}{the National Oceanic and Atmospheric Administration}
\newacronym{pdf}{PDF}{probability density function}
\newacronym{rcp}{RCP}{representative concentration pathway}
\newacronym{slr}{SLR}{sea level rise}
\newacronym{ssp}{SSP}{shared socio-economic pathway}
\newacronym[]{usace}{USACE}{United States Army Corps of Engineers}
\newacronym[]{usgs}{USGS}{United States Geological Survey}
\newacronym[plural=SOWs,firstplural=states of the world (SOWs),descriptionplural=states of the world]{sow}{SOW}{state of the world}
\makeglossaries % required to make the list of acronyms

\usepackage{xspace}
\makeatletter
\DeclareRobustCommand\onedot{\futurelet\@let@token\@onedot}
\def\@onedot{\ifx\@let@token.\else.\null\fi\xspace}
\def\eg{\emph{e.g}\onedot} \def\Eg{\emph{E.g}\onedot}
\def\ie{\emph{i.e}\onedot} \def\Ie{\emph{I.e}\onedot}
\def\etc{\emph{etc}\onedot} \def\vs{\emph{vs}\onedot}

\usepackage{xspace}
\makeatletter
\DeclareRobustCommand\onedot{\futurelet\@let@token\@onedot}
\def\@onedot{\ifx\@let@token.\else.\null\fi\xspace}
\newcommand{\usd}[1]{\SI{#1}[\$]{}}
\def\eg{\emph{e.g}\onedot} \def\Eg{\emph{E.g}\onedot}
\def\ie{\emph{i.e}\onedot} \def\Ie{\emph{I.e}\onedot}
\def\etc{\emph{etc}\onedot} \def\vs{\emph{vs}\onedot}

% use biblatex
\usepackage{csquotes}
\usepackage[
  backend=biber,
  doi=true,
  url=false,
  isbn=false,
  style=authoryear-comp,
  natbib=true,
  backref=false,
  maxbibnames=10,
  maxcitenames=2,
  uniquename=false,
  uniquelist=false,
  sorting=nyt,
  giveninits=true,
]{biblatex}
\renewbibmacro{in:}{}
\AtEveryBibitem{\clearfield{month}\clearfield{day}\clearfield{pages}\clearlist{language}}
\addbibresource{library.bib}

% load this last
\usepackage[hidelinks]{hyperref}
\usepackage{cleveref}

% up to 1250 words
\begin{document}
\maketitle
\thispagestyle{empty}

\begin{abstract}
    Methods for doing so, whether classical standards-based approaches or bottom-up robust methods, make implicit or explicit assumptions about the likelihood of different futures.
    These assumptions may be inconsistent with expert belief.
    In this paper we propose a probabilsitic method for synthesizing across deep uncertainties, using subjective prior beliefs.
    The proposed method can be used in tandem with bottom-up exploratory methods and is consistent with fully probabilistic design criteria.
    Through the lens of a didactic case study of house elevation in Norfolk, VA, we illustrate how this approach can improve the transparency of modeling assumptions.\klaus{Abstract needs a little work}
\end{abstract}

Key points
\begin{enumerate}
    \item Estimated trade-offs between adaptation objectives are sensitive to assumptions about the likelihood of future conditions.
    \item We propose a probabilistic method for transparently synthesizing across deep uncertainty in future conditions.
    \item The proposed method identifies strategies for house elevation that are robust to assumptions in sea level rise.
\end{enumerate}

\clearpage
\section{Introduction}\label{sec:introduction}

Critical infrastructure services in America are aging and inadequate, leading to high-impact failures even during conditions with substantial precedent in the historical record \citep[\eg,][]{doss-gollin_txtreme:2021,doss-gollin_fatalism:2020}.
Looking to the future, it is expected that changes to regulation, economics and finance, patterns of population and infrastructure use, and climate will further stress infrastructure systems.
A critical question, then, is what conditions or futures particular infrastructure systems and components should be designed to withstand.
The answer to this question depends in part on values: intrinsic trade-offs between safety, performance, cost, and other objectives depend on context and stakeholder preferences \citep{keller_management:2021}.
However, this decision is also subject to assumptions regarding the likelihhod and relevance of possible futures.

\subsection{Current practice}

Current practice in engineering, infrastructure design, and local governance relies heavily upon standards that specify particular ``design events'' that buildings and infrastructure should safely withstand \citep{asce_7-10:2013,bruneau_multihazard:2017}.
These are often, though not always, based on probabilistic analysis of relevant data.
For example, \gls{fema}, local governments, and engineering consultants produce local floodplain maps in many communities.
These trigger specific floodplain regulations, such as a nominal requirement for homes purchased through using federally backed mortgage porgrams to be covered by flood insurance \citep{kousky_voucher:2014}.
Additionally, local building codes \citep[based on guidance such as][]{asce_24-05:2006,FEMA_p-55:2011}, may require all houses in flood zones to be elevated some margin above a nominal \gls{bfe}.
Design standards area also used to design large-scale infrastructure.
For example, some levees in the Netherlands are required to be designed such that the annual probability of failure is $<\nicefrac{1}{4000}$ years \citep{eijgenraam_flooding:2014}, while a seawall proposed as part of a \$29 billion coastal protection project proposed for  Galveston Bay, was designed for the annual probability of overtopping to equal 1\%, neglecting the effects of sea level rise \citep[Appendix D.,~p.~2-59]{USACE_coastal:2021}.

Risk-based design \citep{eijgenraam_flooding:2014,vandantzig_dike:1956}\ldots\james{Maybe add a bit here -- this is a low hanging critique}
And homeowners subject high flood risk can apply to programs that fund house elevation; decisions about which projects to fund are made primarily on the basis of cost-benefit ratio tests.
Like standards-based approaches, cost-benefit analyses or risk-based designs rely on probabilistic descriptions of relevant hazard.

Current methods for estimating the probability distributions that underpin cost-benefit analysis or design events focus on data-driven, objective methods that can be applied consistently across locations.
For example, \gls{usgs} Bulletin 17C specifies the procedures for estimating flood frequency and \gls{noaa} Atlas 14 provides estimates of the intensity duration and frequency of extreme rainfall.
A key assumption underlying these approaches is stationarity (see \cite{bulletin17c:2019}, p.~2, or \cite{atlas14_texas:2018} p.~A.4-42).
Yet changes in both global climate and local environmental conditions challenge this assumption in many cases \citep{Merz:2014gf,Milly:2008dg}.
For example, clear trends in extreme rainfall are apparent across much of southeastern Texas \citep{fagnant_spatiotemporal:2020,nielsen-gammon_txrainfall:2020}.
While methods have been proposed for incorporating trends into these analyses \citep[see][for a review]{Salas:2018ge}, these assume specific forms of the trend which may not represent the physical mechanisms that lead to nonstationarity or their uncertainty \citep{DossGollin:2019,Montanari:2014hl,Serinaldi:2015bq}.

\subsection{Emerging paradigms}

Many future hazards depend on intrinsically unpredictable human decisions (\eg, the rate of future greenhouse gas emissions) or on physical processes that are poorly constrained by existing data \citep[\eg, collapse of the West Antarctic ice sheet; see][]{deconto_antarctica:2016} and are therefore deeply uncertain \citep{keller_management:2021,walker_deep:2013,lempert_complex:2002}.
These deeply uncertain nonstationary hazards challenge not only the existing stationary estimates but, more fundamentally, the premise that objective estimates of future hazard exist and can be estimated empirically.

Recognizing the challenges of \gls{dmdu}, many frameworks for identifying robust decisions have been proposed.
Most emphasize the use of models in an exploratory (``what-if'') framework to learn about interactions between decisions and system dynamics \citep{bankes:1993}.
For example, robust decision methods \citep{lempert_shaping:2003} run models over large ensembles of possible futures to assess the performance of different policies, then apply statistical analysis to identify the conditions under which particular policies perform well or poorly.
These methods have been applied to coastal infrastructure planning by sampling \glspl{sow} from a \gls{pdf} of \gls{slr}, then identifying decisions that perform well over many possible futures \citep{sriver_sealevel:2018,lempert_slr:2012,wong_nola:2017}.
When many possible levers are available, and exhaustive sampling therefore infeasible, multiobjective robust decision methods add policy search (using optimization tools) to identify promising actions \citep{kasprzyk:2013,kasprzyk_denovo:2012,hadka_mordm:2015}.
In addition, many studies formally quantify robustness to deep unccertainties \citep{herman:2015,mcphail_robustness:2019} and use this as a criterion for policy comparison.

Although these methods for \gls{dmdu} have proven valuable in a wide range of settings, they still require necessarily subjective assessments about the likelihood of future conditions.
Even exploratory models require the analyst to choose which uncertainties are considered and how they are sampled.
When analyses integrate performance over many possible futures, whether to compute sensitivity of responses to inputs, estimate expectations of functions, or compute robustness metrics, they necessarily make assumptions about likelihood of different scenarios.
Although many analyses contend that specifying a joint probability distribution function over inputs is inappropriate under deep uncertainty, assumptions about the ranges and independence of parameters to sample are just as subjective as the choice of probability distribution \citep{schneider_scenarios:2002,quinn_exploratory:2020} and, indeed, can be interpreted  as a specific choice of probability distribution (we revisit this point in \cref{sec:analysis-condition}).
This motivates the development of decision analytic frameworks that draw from the strengths of \gls{dmdu} methods such as exploratory modeling, vulnerability assessment, robustness checks, and iterative stakeholder critique, but that embrace the necessity of modeling the likelihood of possible futures.

\subsection{Research gaps and objectives}

Recognizing that the assumptions underpinning any decision analysis will necessarily be subjective and imperfect, we draw inspiration from the philosophy of Bayesian model selection, particularly in the ``$\mathcal{M}$-open'' case where there is no true model to identify (\ie, all models are approximations of the truth).
This construct is a theoretical contrast to the ``$\mathcal{M}$-closed'' case, where the goal is to select the ``true'' model from a family of candidate models, and we find many parallels to deep uncertainty.
The theory of model selection in the $\mathcal{M}$-open case emphasizes a subjective view, both of probability itself and of the modeling process, fr which probability distributions offer a self-consistent language with which to reason about the unknown rather than a statement of objective truth (see \cite{gelman_philosophy:2013} or \cite{ramsey_probability:2016} for a philosophical discussion, \cite{jaynes_probability:2003} for a detailed reference, or \cite{Piironen:2017eh} for a discussion of methods for model selection).
From a practical perspective, this literature emphasizes the importance of iteratively building models, simulating the consequences of those models, and subsequently critiquing them \citep{gelman_workflow:2020}.
Since, by definition, the models considered in an $\mathcal{M}$-open world are not ``true,'' this iterative workflow aims to identify models that are ``useful'' \citep{Box:1976gu} and promote a dialogue amongst stakeholders and decisionmakers and analysts \citep{gelman_philosophy:2013}

In this paper we offer a first conceptual step towards bridging the fields of \gls{dmdu} and Bayesian model choice.
We consider the didactic case study of whether to elevate a hypothetical house, and if so how high, as a specific example of a decision problem where both over- and under-investment can lead to undesired outcomes.
Prior studies have found that floodproofing and building-scale vulnerability reduction measures, including house elevation, can effectively reduce local flood damages in many contexts \citep{demoel_reducing:2014,deruig_building:2020,kreibich_building:2005,slotter_floodproofing:2020,Rozer:2016dn,mobley_mitigation:2020,aerts_cost:2018}, and both local building codes \citep{asce_7-10:2013,bruneau_multihazard:2017,asce_24-05:2006} and federal policy \citep{FEMA_p-55:2011} require elevation in some cases.
Guidance for homeowners, notably from \gls{fema}, recommends elevating to the \gls{bfe} (typically the \SI{100}{year} flood) plus a freeboard \citep{fema_retrofitting:2014,asce_24-14:2015,fema_retrofitting:2014} but recent suggests scope for improvement.
For example, this ``one size fits all'' approach can deviate substantially from ``optimal'' guidance tailored to specific homes \citep{xian_elevation:2017}.
Further, that neglecting uncertainty in the cost-benefit analysis can lead to poor decisions \citep{zarekarizi_suboptimal:2020}.
Focusing on deep uncertainty in \gls{slr} over the 71 year design life of a hypothetical house, we seek to answer the research question ``\emph{how can deep uncertainties be transparently and consistently synthesized for decision analysis?}''

We proceed as follows.
In \cref{sec:analysis} we present three formal decision analytic frameworks for analyzing an ensemble of \gls{slr} simulations, building through existing approaches for exploratory modeling (\cref{sec:analysis-explore}) and scenario analysis (\cref{sec:analysis-explore}) towards a formal Bayesian method for transparently synthesizing deep uncertainty through subjective prior beliefs.
In \cref{sec:case-study} we describe the case study in detail.
Next in \cref{sec:results} we discuss results for each of the three theoretical lenses.
Finally in \cref{sec:conclusions} we discuss key findings, future research needs, and implications for research, policy, and practice.

\section{Decision analytic framework}\label{sec:analysis}

In this section we outline our framework for decision analysis under deep uncertainty, maintaining a high level of generality.
In the next we discuss application to the house elevation case study.

Following \cref{fig:flowchart}, consider using $J$ \glspl{sow} $\vb{s} = \qty{s_1, s_2, \ldots, s_J}$ (box b in \cref{fig:flowchart}) to evaluate $I$ discrete decisions $\vb{x} = \qty{x_1, x_2, \ldots, x_I}$ (box a in \cref{fig:flowchart}).
For each scenario $s_j \in \vb{s}$ and decision $x_i \in \vb{x}$ we use a system model $f$ to calculate a set of metrics describing the performance of decision $x_i$ on \gls{sow} $s_j$, which we denote $u_{ij} = f(x_i, s_j)$ (box c in \cref{fig:flowchart}).
While we assume for simplicity that the decision space is are known and finite, this approach could be coupled to a policy search model that proposes candidate decisions $x_i$ from some decision space $\mathcal{X}$.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{bayes-rdm.pdf}
    \caption{
        Outline of the proposed decision-analytic framework.
        In \cref{sec:analysis-explore} we use an exploratory framework to quantify the performance (c) of candidate decisions (a) under a large ensemble of possible futures (b).
        In \cref{sec:analysis-condition} we illustrate the ``multiple PDF problem'' by creating probability distributions over outcomes (e) that are conditional upon specific models describing the likelihood of different futures (d).
        In our case study, these are \gls{rcp} scenarios and physical models of sea level rise.
        Finally in \cref{sec:analysis-synthesize} we propose a subjective Bayesian framework for synthesizing across deep uncertainties by re-weighting sampled futures (f).
    }\label{fig:flowchart}
\end{figure}

\subsection{Explore}\label{sec:analysis-explore}

A first analytical step is to use the model in an ``exploratory'' mode.
Exploratory modeling avoids making explicit assumption about the likelihood different \glspl{sow} and instead seeks to generate new knowledge \citep{bankes:1993}, for example by discovering particularly relevant scenarios  \citep{lamontagne_discovery:2018,groves_scenarios:2007} and mapping a system's response to decisions and \glspl{sow} \citep{Poff:2015jn,Steinschneider:2015kk,sriver_sealevel:2018}.
Although exploratory modeling seeks to avoid explicit assumptions about the likelihood of different futures, subjective modeling decisions including the choice of system model, the set of candidate decisions, the criteria used to assess outcomes, and the choice of how to sample \glspl{sow} \citep[see][]{quinn_exploratory:2020} strongly influence results.
\klaus{Does this address your comment about linking back to observations?}

\subsection{Condition}\label{sec:analysis-condition}

Although exploratory modeling is a useful framework for understanding systems, there are many questions that it cannot answer.
For example, answering questions like ``what is the 95th percentile of some metric under decision $x$'' or ``which decision minimizes expected damages'' or ``what is the probability of failing to satisfy a critical metric''  requires estimating the expectation of some function $\pi$, which has the form
\begin{equation*}
    \mathbb{E}\qty[f(s | x_i)] = \int_{s \in \Omega} p(s) \pi(s | x_i) \dd{s}.
\end{equation*}
Because expectations are defined relative to a probability distribution, \emph{estimating any such expectation requires defining a probability distribution over \glspl{sow}}.

In boxes (d) and (e) of \cref{fig:flowchart} we add this concept to our decision analytic framework.
Given some model $M_k$ specifying a probability over \gls{sow} $p(\Omega)$, we sample $\vb{s} \sim p(\Omega | M)$.
Since the \glspl{sow} are drawn \gls{iid} from $M_k$, the set of outcomes $u_{i, j}$ can be interpreted as \gls{iid} draws from the conditional distribution over outcomes, $p(u | x_i, M_k)$.

Many decision analytic tools used in climate risk management can be interpreted through this lens.
A common application (to which we return in our case study) is when using probabilistic models with deeply uncertain boundary conditions.
For example, \ldots\james{Add a water resources and a flood example}
In this case, $M$ describes both the choice of model and the choice of boundary condition (\eg, choice of physical model and the \gls{rcp} scenario).
As we shall discuss in \cref{sec:results-conditional}, this analysis models uncertainty \emph{within models} probabilistically, but models uncertainty \emph{between models} only using a scenario approach (\ie, choices of model structures or factors such as forcings we show as cases) without any explicit probability statement \citep[see][]{wong_nola:2017}.\james{Wording}

Another application is to studies that generate an ensemble of \glspl{sow} by sampling parameters across fixed ranges.
For example, \citet{lempert_slr:2012} sample parameters describing the rate of \gls{slr} across a range of values to inform coastal adaptation.
Similarly, \citet{trindade_waterpathways:2020} checks the performance of candidate decisions against an ensemble of synthetic time series of streamflow, water demand, and other parameters by sampling parameters that transform the available data over a plausible range \citep[\ie, calculating robustness metrics; see][for details]{mcphail_robustness:2019,herman:2015}.
Since sampling over a range is equivalent to sampling from a Uniform distribution, this method makes an implicit assumption that $M$ is the product of $L$ independent Uniform distributions (one for each parameter) over the plausible ranges $\qty(\theta_{\ell,\min}, \theta_{\ell,\max}) \forall \ell \in \qty{1, \ldots, L}$:
\begin{equation}
    p(\Omega | M) = \prod_{\ell=1}^L \mathrm{Uniform} \qty(\theta_{\ell,\min}, \theta_{\ell,\max}).
\end{equation}
If this product of independent Uniform distributions truly represents a well-calibrated belief about the joint probability distribution over \glspl{sow} $p(\Omega)$ then it should be used, but analysts should be clear that, like it or not, they are making probabilistic assumptions, and should apply methods for model critique and validation \citep[see][]{gelman_workflow:2020}.

Our primary concern is not that subjective assumptions about the likelihood of different futures are wrong -- this is, almost surely, inevitable -- but that when these assumptions are opaque and presented without critique or validation they may lead to poor decisions.

\subsection{Synthesize}\label{sec:analysis-synthesize}

If the ensemble of \glspl{sow} available does not represent our subjective belief about the plausibility of future conditions, then some corrective measure should be taken.
One possibility is to discard the $\vb{s}$ and resample from some ``true'' distribution $p_\mathrm{belief}$.
In practice, this is impractical because simulating $\vb{s}$ may rely on complicated models that are computationally expensive to re-run.
Consequently, climate risk management often uses the outputs of structured simulations and analyses.
For example, many studies use outputs from \gls{cmip} simulations \citep{meehl_cmip:2000} to assess risks and design adaptation strategies.\james{Add some refs}
It is not practical or feasible for end users to re-run such complex Earth system models every time they want to sample \glspl{sow} from a different distribution.

Instead of attempting to re-sample $\vb{s}$, we instead consider re-weighting.
To do this we first project the \glspl{sow} $\vb{s} \in \Omega$ onto a low-dimensional representation, which we denote $\qty{\psi_1, \psi_2, \ldots, \psi_J} \in \Psi$.
This allows us to specify a prior belief over this reduced space $p_\mathrm{belief}(\Psi)$ instead of over the full space $p_\mathrm{belief}(\Omega)$.
We then calculate a probabilistic weight $w_j \in \qty[0, 1]$ for each \gls{sow} $s_j$ so that the weighted distribution of $\psi_j$ closely approximates $p_\mathrm{belief}(\Psi)$.

We present here the case where the $\psi_j$ are one-dimensional.
We first sort the $\psi_j$  from least to greatest so that $\psi_{j-1} \leq \psi_j$, ($j \neq 1$).
Defining $F_\mathrm{belief}(s)$ to be the cumulative distribution corresponding to $p_\mathrm{belief}$, we calculate weights as
\begin{equation}\label{eq:weights}
    w_j = \begin{cases}
        F_\mathrm{belief}\qty(\frac{1}{2}\qty[\psi_1 + \psi_2])                                                                     & j = 1     \\
        F_\mathrm{belief}\qty(\frac{1}{2}\qty[\psi_{j} + \psi_{j+1}]) - F_\mathrm{belief}\qty(\frac{1}{2}\qty[\psi_{j-1} + \psi_j]) & 1 < j < J \\
        1 - F_\mathrm{belief}\qty(\frac{1}{2}\qty[\psi_{J-1} + \psi_J])                                                             & j = J.
    \end{cases}
\end{equation}
This step is illustrated in \cref{fig:grid-sketch}.
For higher dimensional projections, this equation can be extended by partitioning the parameter space into a Voronoi diagram, and then integrating the \gls{pdf} $p_\mathrm{belief}$ over each region.
This approach is widely used in analysis of tropical cyclones: first an ensemble of cyclones is simulated, and then probabilistic weights are calculated for each based on attributes such as intensity, landfall location, and radius \citep{johnson_clara:2013,resio_probabilities:2007,toro_jpm-os:2010}.
From a practical perspective, many simulation models round outputs, meaning that there is a possibility of having $\psi_j$ that are equal; in this case it may be helpful to add a small amount of noise to the $\psi_j$ before computing the weights.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{grid-sketch}
    \caption{
        Schematic of \gls{sow} weighting scheme defined in \cref{eq:weights}.
        This method is illustrated for a hypothetical target distribution (orange line) and $J=4$ samples $\psi_1, \psi_2, \psi_3, \psi_4$ (orange dots).
        As shown in \cref{eq:weights}, the weights $w_j$ (vertical lines) are calculated based on the cumulative distribution function of the target distribution  (black line) at the halfway points $\frac{1}{2}\qty[\psi_i+\psi_{i+1}]$ (vertical dashed lines).
    }\label{fig:grid-sketch}
\end{figure}

The aim of this re-weighting framework is to integrate an ensemble of \glspl{sow} used for exploratory modeling into formal decision analysis.
As in \cref{sec:analysis-condition}, we must condition on a model: where the analysis of \cref{sec:analysis-condition} conditions upon deep uncertainties, the approach outlined in this subsection synthesizes across them.
It is crucially important to understand that stakeholders and experts will not, in general, agree on $p_\mathrm{belief}$ because its uncertainty is epistemic -- that is, there is no ``true'' value of $p_\mathrm{belief}$ that could be estimated if only we had better models and data.
However, reasoning using subjective probability allows\ldots\james{Finish sentence}

\section{Case study}\label{sec:case-study}

We model a one-time decision of whether to elevate a house, and if so by how much (\cref{fig:xlrm}).
We focus on a case study of a \emph{hypothetical} house in Norfolk, VA.
For interpretability, we focus on deep uncertainty in \gls{msl} and treat other model parameters as more shallow uncertainties as shown in \cref{tab:uncertainties}.
We use the notation developed in the previous section to describe the case study.
Specifically,
\begin{enumerate}
    \item The decision vector $\vb{x}$ is a scalar describing how high to elevate a house ($\Delta h$); we consider $\Delta h = \qty{\SI{0}{ft}, \SI{0.25}{ft}, \ldots, \SI{12}{ft}}$ f
    \item The \glspl{sow} describe annual time series of \gls{msl} over the $T=71$ year house lifetime so $\vb{s} \in \mathbb{R}^T$
    \item The system model $f$ quantifies up-front costs and lifetime expected damages, given a decision $x_i$ and \gls{sow} $s_j$, by integrating economic and engineering damage models over a probability distribution for storm surge.
\end{enumerate}
In the remainder of this section we describe data sources and treatment of \gls{slr} (\cref{sec:case-slr}), storm surge (\cref{sec:case-surge}), damages and metrics (\cref{sec:case-metrics}), and finally the subjective priors $p_\mathrm{belief}$ used to apply the re-weighting method described in \cref{sec:analysis-synthesize} to this case study (\cref{sec:case-priors}).

\begin{table}
    \centering
    \caption{
        Summary of parameters, their notation, and how their uncertainty is represented.
        Symbols describing the decision-analytic framework are described in \cref{fig:flowchart}.
    }\label{tab:uncertainties}
    \footnotesize
    \begin{tabular}{p{1.25in} p{0.75in} p{3in}}
        \toprule
        Name                 & Symbol            & Uncertainty                                                                          \\
        \midrule
        \Gls{msl}            & $\overline{y}(t)$ & Deeply uncertain: four physical models $\times$ four \acrshort{rcp} scenarios        \\
        Storm surge          & $y'(t)$           & Probabilistic: Bayesian inference on a stationary \acrshort{gev} model               \\
        Annual maximum flood & $y(t)$            & Deterministic: $y(t)=\overline{y}(t)+y'(t)$                                          \\
        Discount rate        & $1-\gamma$        & Fixed at 2.5\% per year                                                              \\
        Depth-damage         & $D(h-y)$          & Deterministic: based on HAZUS model \citep[see][]{zarekarizi_suboptimal:2020}        \\
        Elevation cost       & $C(\Delta h)$     & Deterministic: a piecewise linear model following \citet{zarekarizi_suboptimal:2020} \\
        Initial height       & $h_0$             & Deterministic: \SI{1}{ft} below the \gls{bfe}, unless otherwise noted                \\
        House floor area     & --                & Deterministic: \SI{1500}{ft^2}                                                       \\
        Structural value     & --                & Deterministic: \usd{200000}                                                          \\
        House lifespan       & $T$               & Deterministic: 71 years                                                              \\
        \bottomrule
    \end{tabular}
    %TODO: check if there are other symbols used
\end{table}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{xlrm.pdf}
    \caption{
        Conceptual diagram of the considered example.
        A \acrfull{sow} consists of a description of the uncertain factors (red).
        We model a problem with a single lever (yellow), which is how high to elevate a house ($\Delta h$).
        For each \acrshort{sow} (red) and each value of $\Delta h$, the system model (blue) is used to calculate performance metrics (gray).
    }\label{fig:xlrm}
\end{figure}

\subsection{\Glsentrylong{slr}}\label{sec:case-slr}

We analyze simulations of \gls{msl} at Sewells Point, VA from four probabilistic physical models using data published in \citet{ruckert_coastal:2019}.
The four models considered are (i) the BRICK model (version 0.2) with slow (``BRICK Slow'') and (ii) fast (``BRICK Fast'') ice sheet dynamics \citep{wong_brick0.2:2017}, (iii) the \citet{kopp_probabilistic:2014} model (``K14''), and (iv) the \citet{deconto_antarctica:2016} model (``DP16'').
The \citet{kopp_probabilistic:2014} and \citet{deconto_antarctica:2016} models have a ten year time step, which we linearly interpolate onto a one year time step for consistency.
These four models represent physical processes, particularly of ice sheet dynamics, in different ways, leading to diverging sensitivity of \gls{msl} to forcing.
For a discussion of these model outputs we refer the reader to \citet{ruckert_coastal:2019}.

Estimates of nonstationary \gls{msl} also depend on anthropogenic forcing, which is itself deeply uncertain \citep{ho_scenarios:2019,srikrishnan_probabilistic:2022}.
To sample this uncertainty, we use simulations from each physical model under four \gls{rcp} scenarios, yielding sixteen time-varying distributions of \gls{msl}.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{lsl-evolution}
    \caption{
        Projections of future mean sea level depend strongly on the choices of physical model and forcing.
        (A): 90\% confidence intervals for mean sea level at Sewells Point, VA as a function of time for a representative subset of three probabilistic models (out of sixteen).
        (B): probability distribution of \gls{msl} at Sewells Point, VA in the year 2100 for each probabilistic model considered.
    }\label{fig:lsl-evolution}
\end{figure}

The choices of physical model and \gls{rcp} scenario jointly determine future \gls{msl} $p(\overline{y}|t)$.
\Cref{fig:lsl-evolution}(a) shows the time-varying 90\% credible intervals of \gls{msl} for three representative models.
The divergence between the the best-case (blue) and worst-case (red) models is small in the early 21st century and increases rapidly thereafter.
\Cref{fig:lsl-evolution}(b) shows the \glspl{pdf} of mean sea level in 2100 (dashed vertical line in panel (a)) under each of the sixteen models considered.
We return in \cref{sec:results-conditional} to the problem that these multiple models poses to decision makers.

\subsection{Storm surges}\label{sec:case-surge}

Following prior work \citep[\eg,][]{garner_slrise:2018,lempert_slr:2012,sriver_sealevel:2018}, we model annual maximum floods $y(t)$ as the sum of sea level $\overline{y}(t)$, described in the previous subsection, and annual maximum storm surges $y'(t)$.

Data on storm surge comes from Sewells Point, VA (gauge 8638610) from the NOAA tides and currents dataset,  freely available to the public at \url{https://tidesandcurrents.noaa.gov/waterlevels.html}.\klaus{I can't find a better reference for this dataset!}
Hourly recordings of water level are available from 1928 to the present; we use data from the period January 1, 1928 to December 31, 2021.
For each calendar year we first remove the annual mean, then calculate the maximum water level.
We refer this time series of annual maximum storm surges as $y'(t)$.
We display this time series of annual maxima storm surges in \cref{fig:surge-obs-return}(a).
The largest recorded surge was the Chesapeake-Potomac hurricane of 1933, which caused a surge of over \SI{7}{ft} at this gauge, but other hurricanes and Nor'easters have caused surges above \SI{6}{ft}.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{surge-obs-return}
    \caption{
        Annual maximum storm surges (after subtracting mean sea level) at Sewells Point, VA.
        (A):
        time series of historic storms.
        Red (yellow) arrows denote notable tropical cyclones (Nor'easters).
        (B):
        return periods.
        Dots indicate observed values; their $x$-value is their plotting position using the Weibull formula (eq.~\ref{eq:weibull}).
        Gray lines show the 50, 80, and 95\% posterior confidence intervals from the Bayesian \gls{gev} fit (\cref{sec:case-surge}).
    }\label{fig:surge-obs-return}
\end{figure}

We model future storm surge using a stationary \gls{gev} model:
\begin{equation}\label{eq:surge-model}
    y'(t) \sim \text{GEV}\qty(\mu, \sigma, \xi),
\end{equation}
where $y'(t)$ is the storm surge (above sea level) in year $t$ and a \gls{gev} distribution with location, shape, and scale parameters $\mu$, $\sigma$, and $\xi$, respectively, has the probability density function given in \cref{eq:gev-dist}.
This model assumes stationarity, neglecting any potential time dependence.

Our approach to model building follows a principled workflow for model building and checking \citep[see][for details]{gelman_workflow:2020}.
One model choice, analogous to the choice of statistical distribution or the assumption of stationarity, is the choice of how to represent prior information.
We include two forms of prior information.
First, we constrain the shape parameter to be positive, $\xi > 0$, to reflect knowledge about the support of $y'$, which for a variable distributed according to \cref{eq:gev-dist} is:
\begin{equation*}
    \mathrm{supp}~ y' =
    \begin{cases}
        \xi < 0: & y' \in \qty(-\infty,~ \mu - \nicefrac{\sigma}{\xi}) \\
        \xi > 0: & y' \in \qty(\mu-\nicefrac{\sigma}{\xi},~ \infty).
    \end{cases}
\end{equation*}
Since storm surges cannot be negative, only the latter is physically defensible, justifying our choice to constrain the shape parameter to be positive.
Second, we add weakly informative priors.
Rather than applying prior information directly over the joint distribution of the priors $\qty{\mu,\sigma,\xi}$, we instead apply a prior over extreme quantiles of the distribution, as in \citet{coles_evd:1996}.
Specifically, we apply Inverse Gamma priors over the 2, 10, 100, and 500 year return levels, with means \SIlist{4;6;10;15}{ft} and standard deviations \SIlist{1.5;1.75;2.25;2.75}{ft}, respectively.
The parameters of the Inverse Gamma distribution can be calculated from these moments (see \cref{eq:inv-gamma-params}).
These means and standard deviations were chosen to represent plausible physical ranges and are plotted in \cref{fig:surge-gev-priors}.

For inference, we draw \num{10000} samples from the posterior distribution $p(\mu,\sigma,\xi | y')$ using Hamiltonian Markov Chain Monte Carlo \citep{Betancourt:2017vd,hoffman_nuts:2011} implemented in the Turing package of the Julia programming language \citep{perkel_julia:2019,ge_turing:2018,tarek_dynamicppl:2020,besancon_distributions.jl:2021,bezanson_julia:2012}.
Diagnostics suggest (though cannot guarantee) convergence (see \cref{tab:surge-posterior-mcmc-diagnostics}).
We evaluate the model's fit using posterior predictive checks \citep[see][section 2.4 and references therein]{gelman_workflow:2020}.
Using the lag 1 and 2 partial autocorrelations, sample maximum, sample minimum, sample median, and Mann-Kendall test value as Bayesian test statistics, we found that draws from the posterior predictive distribution matched the observed test statistics credibly (\cref{fig:surge-test-statistics}) although panels (a) and (b) suggest the possibility of temporal structure not captured by our stationary \gls{iid} model.
Future efforts could represent this structure by conditioning the parameters of the distribution on relevant climate indices \citep[as in][]{wong_structural:2020,Farnham:2016tw,farnham_jetstream:2017}.

\Cref{fig:surge-obs-return}(b) shows the estimated return periods for these storm surges.
The return period of the data (dots) is shown using the Weibull (``empirical'') plotting position (see \cref{eq:weibull}).
The good fit of the Bayesian fit (gray shading) to the data (points) suggest the modeling choices made are reasonable and sufficient for this didactic example.
A positive control test (\cref{fig:surge-synthetic-data-experiment}) also validates the model's ability to recover known parameter values.

\subsection{Damages and metrics}\label{sec:case-metrics}

The system model (``relationships'' in \cref{fig:xlrm}) is comprised of two key pieces.
The first is a fragility model that estimates the expected flood damages for a particular year (``expected annual damages''), given the elevation of the house and the mean sea level for that year.
The second converts model converts a time series of annual expected damages into lifetime expected damages.

We define expected annual damages in year $t$ as the expectation of the damage function with respect to storm surge.
This expectation depends on the house's height ($h = h_0 + \Delta h$) where $h_0$ is the initial height relative to the gauge and $\Delta h$ is the amount by which the house is elevated.
The expected annual damage is thus
\begin{equation}\label{eq:ead}
    \textrm{EAD}(t) = \mathbb{E}[D \qty(h-\overline{y}(t))] = \int_{y'} p(y') D \qty(h - \qty(\overline{y}(t) + y')) \dd{y'},
\end{equation}
where $D(h-y)$ is a deterministic function specifying damage as a function of flood depth (relative to the house).
Following \citet{zarekarizi_suboptimal:2020} we use the we use the Hazard U.S. (HAZUS) depth-damage curves provided by \gls{fema}; this depth-damage relationship is shown in \cref{fig:cost-depth-damage}.
For comparison, \cref{fig:cost-depth-damage} also shows the ``Europa'' depth-damage relationship developed by the Joint Research Center of the European Commission's science and knowledge service \citep{huizinga_depthdamage:2016}.
Although \citet{zarekarizi_suboptimal:2020} demonstrate that the choice of fragility function is important for informing house elevation, we use only the HAZUS model for simplicity.

The expected annual damage is sometimes calculated by assuming analytically tractable functional forms for the depth-damage relationship and for the  distribution of hazard \citep[\eg][]{vandantzig_dike:1956}.
However, the convolution of the HAZUS depth-damage equation with the \gls{gev} posterior does not have a tractable analytic solution so we instead estimate it through a Monte Carlo method (see \cref{sec:alg-ead} for details).
Then, because the expectation in \cref{eq:ead} depends only on $h-\overline{y}(t)$, we calculate expected annual damages for a wide range of possible heights, then use this to train a computationally efficient a surrogate model (see \cref{sec:surrogate-ead}).

The second component of the system model converts a time series of $\mathrm{EAD}$ into lifetime expected damages, which we define as the up-front  discounted sum of expected annual damages:
\begin{equation}\label{eq:led}
    \textrm{LED} = \sum_{t=t_i}^{t_f} \gamma^{\qty(t-t_i)-1} \textrm{EAD}(t),
\end{equation}
where the discount rate is $1 - \gamma$, the initial time $t_i=2022$, and the end time $t_f = t_i + T$.
Although \citet{zarekarizi_suboptimal:2020} show that uncertainty in the discount rate is important for decision support, we use a fixed discount rate (see \cref{tab:uncertainties}) for the purposes of this didactic study.
For a more theoretical discussion see \citet{arrow_discount:2013}.

To assess the performance of a given decision for a specific \gls{sow} (``Metrics'' in \cref{fig:xlrm}), we calculate the following metrics for each decision-\gls{sow} combination:
\begin{enumerate}
    \item ``Up-front cost'' is the cost of elevating a house. Following \citet{zarekarizi_suboptimal:2020}, we use estimates of construction cost from the Coastal Louisiana Risk Assessment \citep{fischbach_clara:2012}. We normalize this cost by house value. This cost curve is shown in \cref{fig:cost-up-front}.
    \item ``Lifetime expected damages'' is calculated following \cref{eq:led}.
    \item ``Expected lifetime costs'' is the sum of lifetime expected damages and up-front costs.\james{Make sure the figures all use this term}
\end{enumerate}

\subsection{Prior over \glsentrylong{slr}}\label{sec:case-priors}

We construct three probabilistic models for $p_\text{belief}(\psi)$, which represents the amount of \gls{slr} from 2022 to 2100.\james{Expand a bit on other work and priors for SLR.}
Refer to \citet{lempert_slr:2012,sriver_sealevel:2018,garner_slrise:2018}.

We use a Gamma distribution for all three priors, parameterized as
\begin{equation*}
    f(x | \alpha, \theta) = \frac{x^{\alpha-1} e^{-x/\theta}}{\Gamma(\alpha) \theta^\alpha},
    \quad x > 0.
\end{equation*}
\Cref{tab:slr-priors} specifies these priors, as well as some quantiles of the distributions.
Their \glspl{pdf} are also plotted in \cref{fig:lsl-priors-weights}(A).

\begin{table}[h]
    \centering
    \caption{
        Subjective priors over \gls{slr} from 2022 to 2100, \ie $p_\text{belief}(\psi)$.
        The name of the distribution, the parameters of the Gamma distribution with shape $\alpha$ and scale $\theta$, and the 2.5, 25, 50, 75, and 97.5th percentiles.
    }\label{tab:slr-priors}
    \input{../../plots/lsl_priors.tex}
    % TODO: add another column: Parameter and Quantiles [in feet]
\end{table}

We developed these priors for didactic purposes, to illustrate a range of possible beliefs.
We can compare them, for example, with analysis published by \gls{noaa}, which project \SIlist{1.94;2.62;4.27;5.25;6.89}{ft} for the low, intermediate, low intermediate, intermediate high, and high scenarios, respectively \citep[table.~2.4]{sweet_slr:2022}.

Future work could develop improved, policy-relevant priors, either by combining probabilistic models for emissions \citep[as in][]{srikrishnan_probabilistic:2022}, climate sensitivity, and the \gls{slr}, or through inversion of expert opinion \citep[as in][]{fuller_inversion:2017}.
Future work could also consider more sophisticated priors, either by considering higher-dimensional $\psi$ or by modeling a joint prior over model inputs and model outputs through melding \citep{poole_melding:2000,sevcikova_melding:2007}.

\section{Results and discussion}\label{sec:results}

We illustrate our approach to synthesizing uncertainties by sequentially analyzing the house elevation problem through the lenses of exploratory modeling (\cref{sec:results-exploratory}), scenario-conditional analysis (\cref{sec:results-conditional}), and finally the proposed synthesis method (\cref{sec:results-synthesis}).

\subsection{Exploratory modeling}\label{sec:results-exploratory}

We begin by using our model in an ``exploratory'' mode with an aim of learning about interactions between system dynamics and decisions.

\begin{figure}
    \includegraphics[width=\textwidth]{scenario-map-slr-cost}
    \caption{
        Scenario maps show the dependence of expected lifetime cost (damages plus up-front cost) as a function of \gls{msl} in 2100 for several values of initial height ($h_0$) and house elevation ($\Delta h$).
        Colors indicate the density of \glspl{sow}; the color of each grid box corresponds to the number of \glspl{sow} falling within that box.
        The lowest-cost outcomes occur when both exposure is low ($h_0$ is large and \gls{slr} is minimal) and the house is not elevated (no up-front cost).
        The highest-cost outcomes arise when exposure is high ($h_0$ is small and \gls{slr} is rapid) and investment is inadequate.
        In all cases, elevating the house reduces the variance in total lifetime cost.
        Values are sensitive to model constants; see \cref{tab:uncertainties}.
    }\label{fig:scenario-map-slr-cost}
\end{figure}

\james{Start with a summary sentence that outlines the paragraph}\Cref{fig:scenario-map-slr-cost} shows the dependence of expected lifetime costs (damages plus up-front costs; $y$-axis) as a function of  \gls{slr} over the house lifetime ($x$-axis), height increase ($\Delta h$; columns), and initial elevation ($h_0$; rows).
The outcomes with lowest total lifetime costs arise when the house is not elevated ($\Delta h = 0$) and \gls{slr} is minimal (bottom left corners).
The outcomes with highest total lifetime costs arise when the house is elevated only slightly and \gls{slr} is rapid.
As $\Delta h$ increases, the best-case scenario becomes more expensive because up-front costs increase, but worst-case scenarios become less expensive because even if \gls{slr} is substantial, damages will be negligible.

This analysis answers ``what-if'' questions like ``given $h_0$ and $\Delta h$, what is the range of total costs a homeowner could face if \gls{slr} over the house lifetime is \SI{1}{ft} or \SI{10}{ft}.''
For some decision-makers, contextualizing this information against a few scenarios of \gls{slr} \citep[\eg, those of][]{sweet_slr:2022} may prove sufficient for decision making.
This would be analogous to decision scaling methods that plot climate model projections on a scenario map of water system performance as a function of changes in key climate variables \citep{Brown:2012kb,Steinschneider:2015kk}.
However, this analysis does not shed light on cost-benefit analyses or return periods, nor does it permit quantitative comparison against other possible decisions.\james{Strong statement. Correct? What if we make or use strong implicit assumptions?}

\subsection{Scenario-conditional optimization}\label{sec:results-conditional}
We now turn to the scenario-conditional analysis described in \cref{sec:analysis-condition}.
Whereas the exploratory analysis of the previous subsection interpreted each time series of future sea level as a sample from the space of possible futures, we can also interpret each \gls{sow} as a draws from one of the sixteen models of \gls{slr} shown in \cref{fig:lsl-evolution}.
As discussed in \cref{sec:analysis-condition}, this allows a probabilistic interpretation: conditional on a particular \gls{rcp} scenario and physical model, we can reason about the distribution of outcomes.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{tradeoffs-by-rcp}
    \caption{
        Each probabilistic model or scenario leads to a different estimate of the Pareto frontier.
        For emphasis, we highlight three representative models: the Brick Slow model \citep{wong_brick0.2:2017} under \gls{rcp} 2.6, the K14 \citep{kopp_probabilistic:2014} model under \gls{rcp} 6.0 and the DP16 model \citep{deconto_antarctica:2016,kolpin_introduction:2017} under \gls{rcp} 8.5.
        (A): trade-off between up-front cost (which is a monotonic function of height increase) and expected lifetime costs.
        (B): trade-off between up-front cost and lifetime expected damages (eq.~\ref{eq:led}).
        Light gray lines show estimates for all 16 models (four \gls{rcp} scenarios times four physical parameterizations) considered.
        Colored lines highlight three representative models for emphasis.
    }\label{fig:tradeoffs-by-rcp}
\end{figure}

This probabilistic interpretation allows us to compute, for example, expected values.
For example, \cref{fig:tradeoffs-by-rcp}(a) plots the expected total lifetime cost as a function of $\Delta h$ for the sixteen models considered (we highlight three representative models).
Similarly, \cref{fig:tradeoffs-by-rcp}(b) plots the lifetime expected damages as a function of $\Delta h$.
This figure shows that for small $\Delta h$, expected costs are low under optimistic models (\eg, \gls{rcp} 2.6 with slow ice sheet dynamics) and high under pessimistic models (\eg, \gls{rcp}8.5 with the DP16 model).
Consistent with \cref{fig:scenario-map-slr-cost}, the variability of lifetime costs decreases as $\Delta h$ increases.
Once $\Delta h$ reaches \SIrange[]{3}{7}{ft}, depending on the model considered, construction costs start to dominate flood losses, and thus higher values of $\Delta h$ increase average lifetime costs.

This approach is, in a sense, another form of exploratory modeling: instead of considering a very large ensemble of \glspl{sow}, we consider a much smaller set of probabilistic models.
This approach is attractive because it allows modelers to focus on their domain expertise (\eg, the response of ice sheets and global sea levels to a particular climate future).
However, conditioning simulations on a set of climate futures and physical models presents what we term ``the multiple \gls{pdf} problem'' because it leaves decision makers with many \glspl{pdf} to choose from.
The multiple \gls{pdf} problem has also been shown in other contexts.
For example, \citet{sharma_rcp:2021}\klaus{According to Earth's Future this is in fact 2021} modeled the reliability of stormwater infrastructure under different climate models and downscaling methods, finding diverging estimates of future rainfall hazard, even under a single \gls{rcp} scenario.\james{Other examples: Wong et al 2017 -- levees. There are more!}
Although this scenario-conditional analysis is appropriate for understanding differences between models, its key limitation is that \emph{it places the burden for deciding which model to design for onto the end user.}

\subsection{Synthesizing deep uncertainties for decision analysis}\label{sec:results-synthesis}

The proposed approach can help overcome the limitations of scenario-conditional analysis.
We illustrate how the re-weighting method described in \cref{sec:analysis-synthesize} can shed light on climate risk management under deep uncertainty.
We present results using each of the models for $p_\mathrm{belief}$ outlined in \cref{sec:case-priors}.
These three distributions are shown in \cref{fig:lsl-priors-weights}(A).

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{lsl-priors-weights}
    \caption{
        Subjective priors for local sea level.
        We develop two distributions (``subjective priors'') representing plausible probabilistic beliefs about \gls{msl} at Sewells Point, VA in 2100, relative to the present.
        The \glspl{pdf} of these subjective priors are shown in panel (A).
        In panels (B-C) we show the relationship between these subjective priors and the 16 probabilistic models (four \gls{rcp} scenarios and four physical representations) available.
        Specifically, (B-C) show the average weight given to each model by each of the subjective priors.
    }\label{fig:lsl-priors-weights}
\end{figure}

One application of this method is to diagnose which assumptions different $p_\text{belief}$ are consistent with.
\Cref{fig:lsl-priors-weights}(B-D) shows the average weight that each prior assigns to \glspl{sow} generated by each \gls{rcp} scenario and physical model.
For example, the rapid \gls{slr} scenario places most weight on the DP16 model, and particularly on \gls{rcp} 8.5 which is unlikely given current policy \citep{hausfather_scenarios:2020,srikrishnan_probabilistic:2022}.
Conversely, the slow \gls{slr} scenario places most weight on the BRICK models, particularly \gls{rcp} 2.6 (also unlikely given current policy) and \gls{rcp} 4.5.
The uncertain \gls{slr} scenario places approximately equal weight across models.

This method can also be used to calculate expectations, allowing us to revisit the trade-off diagrams of \cref{fig:tradeoffs-by-rcp}.
\Cref{fig:tradeoffs-by-prior} shows the total lifetime cost (panel A) and lifetime expected damages (panel B) under each model.
Notably, they give different guidance.\james{Say what this guidance is}
Under an assumption of rapid \gls{slr}, elevating the house by approximately \SI{6}{ft} saves approximately 25\% of the house value relative to not elevating.
Under an assumption of slow \gls{slr}, elevating the house by \SI{6}{ft} costs approximately 25\% of the house value relative to not elevating.
Under the intermediate / uncertain \gls{slr} assumption, the expected lifetime costs are similar for elevating or not elevating the house.
Under all assumptions, elevating by only a few feet is impractical because it involves paying the large fixed costs of elevation (\cref{fig:cost-up-front}) but offers relatively little flood reduction.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{tradeoffs-by-prior}
    \caption{
        As \cref{fig:tradeoffs-by-rcp}, but Pareto frontiers are shown for the full distribution of outcomes, for three models of $p_\text{belief}$ (colors).
        Thin gray lines show the trade-off curves for each \gls{rcp} scenario and model separately as in \cref{fig:tradeoffs-by-rcp}.
    }\label{fig:tradeoffs-by-prior}
\end{figure}

\section{Conclusions}\label{sec:conclusions}

The motivation for this study was to develop a framework for increasing the transparency of assumptions about the likelihood of different \glspl{sow}.
Additionally, we sought to develop a framework capable of blending iterative, stakeholder-driven exploratory modeling with subjective probabilistic expert assessment.
Such an approach is urgently needed given that deeply uncertain nonstationarity hazards pose a fundamental challenge to classical methods of hazard estimation.
In this paper we proposed a decision analytic framework for synthesizing across deep uncertainties that is compatible with exploratory modeling.
Through a case study of house elevation in the coastal zone, we show that:\klaus{I'd actually love feedback on these -- they can more or less parallel the key points but it would be really helpful for me to see what you think the key points are}
\begin{enumerate}
    \item estimated design trade-offs are highly sensitive to the choice of scenario;\klaus{This seems self-evident, though}
    \item implicit or explicit assumptions about the likelihood of different scenarios are inevitable; and
    \item the method proposed in \cref{sec:analysis-synthesize} can transparently synthesize across deep uncertainties.
\end{enumerate}


There are several limitations to our study that merit further discussion here.
The first category has to do with limitations of the underlying methodology proposed for reweighting state of the world.
For example, we develop a subjective prior belief $p_\mathrm{belief}(\Psi)$ over \gls{msl} in the year 2100.
Although this is a low-dimensional projection of the full time series, it is not a sufficient statistic.
It is known that in approximate Bayesian computation, calibrating models on low dimensional statistics that are not sufficient statistics can lead to biased estimates of the posterior \citep{csillery_abc:2010,marjoram_abc:2006}.
Although we are not performing calibration here, and this is thus not a direct concern, time series with the same \gls{msl} in 2100 may differ in other ways, and experts may have prior information about the likelihood of these differences.
A related concern is that we developed our three distributions for $p_\mathrm{belief}(\Psi)$  in an \emph{ad hoc} fashion that may not represent well-calibrated beliefs.
Although this is appropriate for our didactic illustration, we suggest that recent advances in Bayesian elicitation of expert opinion \citep[see][and references therein]{mikkola_elicitation:2021} should be applied to formal guidance.
Another important point is that the gridding approach of \cref{eq:weights} implicitly assumes that the space is well spanned; this is not necessarily true but is a goal of exploratory modeling.\james{revisit}
More fundamentally, our method assumes that there exists an expert capable of integrating over the many processes that drive \gls{slr}, from global greenhouse gas emissions to the global carbon cycle to climate sensitivity and ice sheet response.
An alternative approach would be to fully couple these models together to generate samples from the full distribution of \gls{slr}.
Yet while some progress has been made developing probabilistic models for specific elements of this model chain \citep[\eg,][]{srikrishnan_probabilistic:2022}, coupling these models remains a computational and conceptual challenge.\klaus{Is this too vague?}
Finally, while our aim in this paper has been to demonstrate the value of integrating Bayesian workflow \citep{gelman_workflow:2020} into \gls{dmdu}, further work is needed to improve this integration.

The second category of limitations has to do with the case study and our interpretation of the house elevation decision problem.
This problem intersects with decisions about where to live and how to manage household finances, both of which are highly complex.
We could extend our analysis, for example, by considering additional decision objectives representing risk aversion, usable space created under the house, non-financial consequences of flooding, or other factors.
We could also extend the analysis to consider additional sources of uncertainty such as depth-damage relationships \citep{Rozer:2019,nofal_fragility:2020}, the cost of elevating a house, the house lifespan, the effective discount rate, and value of the land on which the house is built \citep[provides a framework for addressing some of these]{zarekarizi_suboptimal:2020}.
Finally, while here we consider the decision to be a one-time decision, it can also be framed as a sequential decision.
Analysis of sequential decision problems applies tools from control theory and reinforcement learning to identify policies that map ``triggers'' (\ie, state variables) to decisions.
Yet although framing the decision through a sequential lens can increase adaptability and improve outcomes \citep{fletcher:2017,garner_slrise:2018}, the optimized policy rules are necessarily sensitive to the characterization of uncertainty, and thus the problem of synthesizing across deep uncertainties remains \citep{herman_control:2020}.

These limitations motivate several directions for future research.
From a methodological perspective, developing model chains that capture uncertainties in global energy and economic pathways, global climate sensitivity, and local hazard response \citep[see fig.~1 of][]{moss_uncertainties:2000} offers a principled framework for fully probabilistic estimates of local hazard, subject to (still necessarily subjective) priors over key parameters.
From a decision support perspective, improved understanding of the conditions under which household-scale strategies for flood risk management, like elevation, achieve relevant objectives could support improved resilience and adaptation.
Additionally, since developing bespoke analyses for each house may be impractical, identifying decision rules that scale to different house characteristics may add value.

The scenario weighting framework described in \cref{sec:analysis-synthesize} and illustrated in this paper can be applied to inform critical challenges in climate risk management.
An obvious area of application is to the design of infrastructure for climate risk management.
For example, much of the stormwater infrastructure in the United States is inadequate for current climate \citep{lopez-cantu:2018}, let alone future changes.
Yet upgrading this infrastructure is costly and subject to large uncertainties between rainfall models \citep{sharma_rcp:2021} and \gls{rcp} scenarios.
Similarly, decisions like  levee heightening \citep{garner_slrise:2018,oddo_coastal:2017,vandantzig_dike:1956} and sea wall design (as discussed in the Introduction) are subject to deep uncertainties in sea level rise.
This framework can also be applied to uncertainties in non-physical variables.
For example, investments in water resources planning and management depend on assumptions of future water demand, availability, and technologies \citep{trindade_deeplyuncertainpathways:2019}.
Similarly, analyses of climate change mitigation options, such as estimates of the social cost of pollutants \citep{errickson_methane:2021} or cost-minimizing energy transition pathways,\james{cite} are conditional on probabilistic models for inputs like technology prices and population.

Ultimataely, all models of the future are flawed.
Seeking decisions that perform well even when assumptions are broken through robust design and flexibility generally improves outcomes.
Yet whenever decisions are comppared quantitatively, assumptions about the likelihood of different possible futures are necessarily made.
We call for researchers studying climate risk management to make these implicit assumptions, and we suggest that coordinated national and international guidance can help local governments and engineering bodies determine appropriate design criteria.\klaus{OK with this?}

\section*{End Matter}

\subsection*{Acknowledgements}

This work was supported by \acrfull{noaa} through the Mid-Atlantic Regional Integrated Sciences and Assessments (MARISA) program under NOAA grant NA16OAR4310179 and by the Penn State Center for Climate Risk Management.
JDG thanks Rice University for support.
KK thanks Dartmouth College for support.
The authors thank Tor Erlend Fjelde for helpful comments.

\subsection*{Code and data availability}

All code, including source code, is available under the GNU Public License (version 3) at \url{https://github.com/jdossgollin/2021-elevation-robustness}.
This code is written in the open source Julia programming language.

\subsection*{Author Contributions}

JDG and KK designed the research.
JDG wrote the codes and ran simulations.
JDG wrote the manuscript in consultation with KK.
JDG and KK revised the manuscript.

\printbibliography

\appendix
\newcommand{\hbAppendixPrefix}{S}
\renewcommand{\thefigure}{\hbAppendixPrefix\arabic{figure}}
\setcounter{figure}{0}
\renewcommand{\thetable}{\hbAppendixPrefix\arabic{table}}
\setcounter{table}{0}
\renewcommand{\theequation}{\hbAppendixPrefix\arabic{equation}}
\setcounter{equation}{0}

\newpage

\printglossary[type=\acronymtype,title=List of Abbreviations]

\section{Supplemental methods}

\subsection{Storm surge statistical modeling}

We parameterize the \gls{gev} distribution as
\begin{equation}\label{eq:gev-dist}
    f(x | \mu, \sigma, \xi)= \begin{cases}
        \frac{1}{\sigma} \qty[ 1 + \qty( \frac{x-\mu}{\sigma} ) \xi ]^{-1 / \xi - 1} \exp \qty{- \qty[1+\qty(\frac{x-\mu}{\sigma}) \xi ]^{-1 / \xi} }, & \xi \neq 0 \\
        \frac{1}{\sigma} \exp \qty{-\frac{x-\mu}{\sigma}} \exp \qty{ -\exp \qty[-\frac{x-\mu}{\sigma}]},                                               & \xi=0.
    \end{cases}
\end{equation}

Parameterizing the Inverse Gamma distribution as
\begin{equation}\label{eq:inv-gamma-dist}
    f(x | \alpha, \theta) = \frac{\theta^\alpha x^{-(\alpha + 1)}}{\Gamma(\alpha)} e^{-\frac{\theta}{x}}, \quad x > 0,
\end{equation}
the parameters $\alpha$ and $\theta$ can be computed from the desired mean $\mu$ and standard deviation $\sigma$ as
\begin{align}\label{eq:inv-gamma-params}
    \begin{split}
        \alpha &= 2 + \frac{\mu^2}{\sigma^2} \\
        \theta &= \mu \qty(\alpha - 1).
    \end{split}
\end{align}

The plotting position used in \cref{fig:surge-obs-return} is the Weibull (``empirical'') plotting position
\begin{equation}\label{eq:weibull}
    \nicefrac{r}{N + 1}
\end{equation}
where $N$ is the sample size and $r$ is the order of the $N$ observations ($r=1$ is the largest, $r=N$ is the smallest).

\subsection{Algorithm to estimate expected damages}\label{sec:alg-ead}

We use a Monte Carlo integration to estimate expected damages as a function of house elevation and \gls{msl}, $D(h-y(t))$.
\begin{enumerate}
    \item For $m=1, \ldots, M$:
          \begin{enumerate}
              \item draw a sample from the posterior distribution of storm surge (see \cref{eq:surge-model})  $\qty{ \mu_m, \sigma_n, \xi_m}$
              \item simulate a single storm surge from this stationary \gls{gev} distribution and add the mean sea level to get total flood depth $y^\mathrm{sim}_m$
              \item calculate the flood damages for this draw by plugging the annual maximum flood depth ($h - y_k$) into  the deterministic HAZUS depth-damage relationship, storing this as the $m$th damage.
          \end{enumerate}
    \item Estimate expected annual damages as the sample mean of the $M$ estimates
\end{enumerate}

\subsection{Surrogate model for expected annual damages}\label{sec:surrogate-ead}
Evaluating expected annual damages for each of $N$ simulations of \gls{slr}, each of $J$ draws from the posterior distribution of storm surge, and each of $T$ time steps for $K$ models requires $N \times J \times T \times K$ simulations.
In our model, we have $T=71$, $J=\num{10000}$, $N=\num{179232}$, and in general .
However, noticing that this function depends only on the elevation of the house relative to \gls{msl}, we develop a simple emulator for expected annual damages given this difference: $\hat{D}(h - \overline{y})$.
To do this, we  precompute expected annual damage for all height differences in \SI{0.25}{ft} increments from \SIrange{-30}{30}{ft} and fit a piecewise linear interpolation to this data.
We use $K=\num{1e6}$ samples to fit this emulator for each of the 241 increments.
This model is shown in \cref{fig:cost-expected-damage-emulator}.
Once this interpolation has been precomputed, calculating expected annual damage for a particular year only requires evaluating a piecewise linear function.

\section{Supplemental figures}

\begin{figure}
    \centering
    \includegraphics[width=4in]{cost-depth-damage}
    \caption{
        Depth-damage relationship.
        Following \citet{zarekarizi_suboptimal:2020}, we use the Hazard U.S. (HAZUS) depth-damage curves provided by \gls{fema}.
        Since results are sensitive to choice of depth-damage equation, we illustrate (for comparison only) the ``Europa'' depth-damage relationship developed by the Joint Research Center (JRC) of the European Commission's science and knowledge service \citep{huizinga_depthdamage:2016}.
    }\label{fig:cost-depth-damage}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=4in]{cost-expected-damage-emulator}
    \caption{
        As discussed in \cref{sec:case-metrics}, we model expected annual damages (eq.~\ref{eq:ead}) as a function of the house's elevation relative to \gls{msl}.
        Damages ($y$ axis) are shown as a percentage of house value.
    }\label{fig:cost-expected-damage-emulator}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=4in]{cost-up-front}
    \caption{
        Following \citet{zarekarizi_suboptimal:2020}, we model the cost of elevating a single-family house by interpolating estimates from the Coastal Louisiana Risk Assessment Model \citep{johnson_clara:2013}.
        According to this model, the unit cost of elevating a house by 3-7, 7-10, and 10-14 feet is \usd{82.50}, \usd{86.25}, and \usd{103.75} per square foot, respectively, with a \usd{20745} initial cost.
        Values are sensitive to house floor area and structural value; see \cref{tab:uncertainties}.
    }\label{fig:cost-up-front}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=4in]{surge-gev-priors}
    \caption{
        Prior distributions for annual maximum storm surge.
        Rather than apply a prior over model parameters directly, we apply a weakly informative prior over quantiles of the resulting distribution (that is, over a function of the model parameters) following \citet{coles_evd:1996}.
        See \cref{sec:case-surge} for details.
        For the 2, 10, 100, and 500 year events we apply Inverse Gamma distributions, with means \SIlist{4;6;10;15}{ft} and standard deviations \SIlist{1.5;1.75;2.25;2.75}{ft}, respectively.
    }\label{fig:surge-gev-priors}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{surge-prior-return}
    \caption{
        Surge prior
    }\label{fig:surge-prior-return}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{surge-synthetic-data-experiment}
    \caption{
        Synthetic data experiment as a positive control test for the \gls{gev} model of storm surge.
        A synthetic record was sampled from a \gls{gev} distribution with location, scale, and shape parameters of 4, 0.5, and 0.15, respectively (dots).
        These samples were used to fit the Bayesian \gls{gev} model described in \cref{sec:case-surge}; the gray shading indicates the 50, 80, and 95\% posterior confidence intervals.
        The blue line shows the true quantiles of the (known) \gls{gev} distribution.
        By random chance the sample maximum has a true return period of $\gg 250$ years, which increases the upper confidence interval of the estimated return probabilities, but the true value is nevertheless within the 50\% posterior confidence interval.
        This experiment yields similar results for alternative values of the known \gls{gev} distribution, and for different random seeds (not shown).
    }\label{fig:surge-synthetic-data-experiment}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{surge-posterior-chains}
    \caption{
        Markov chain diagnostic plots for posterior draws from the storm surge model.
        We draw \num{10000} samples by running four chains of \num{3500} iterations each and discarding the first \num{1000}.
        The mixing of the chains is consistent with, though does not guarantee, convergence.
    }\label{fig:surge-posterior-chains}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{surge-prior-chains}
    \caption{
        As \cref{fig:surge-posterior-chains} but for draws from the prior distribution.
    }\label{fig:surge-prior-chains}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{surge-test-statistics}
    \caption{
        Posterior predictive checks for the stationary \gls{gev} storm surge model (\cref{sec:case-surge}).
        Each panel shows a different test statistic: partial autocorrelation at lags 1 and 2; sample maximum; sample minimum; sample median; and Mann-Kendall trend test statistic.
        The histograms show the distribution of each test statistic from the posterior predictive distribution.
        Orange lines show the test statistic's value in the observed data.
        Observed values near the mode of the posterior predictive distribution are consistent with, but do not guarantee, a good fit.
        For further discussion of posterior predictive checks, see Chapter 6 of \citet{Gelman:2014tc}.
    }\label{fig:surge-test-statistics}
\end{figure}

\begin{figure}
    \includegraphics[width=\textwidth]{scenario-map-height-slr}
    \caption{
        Expected total lifetime cost (damages plus up-front cost) as a function of \gls{slr} over the house lifetime and height increase $\Delta h$.
        Initial house elevation is fixed to \SI{1}{ft} below the \gls{bfe}.
        Expectations were computed for discrete values of $\Delta h$ ($x$ axis) by discretizing \glspl{sow} ($y$ axis), then taking the sample mean over each grid cell.
    }\label{fig:scenario-map-height-slr}
\end{figure}

\section{Supplemental tables}

\begin{table}[h]
    \centering
    \caption{
        Diagnostic statistics for the Hamiltonian Monte Carlo sampling for the storm surge posterior draws.
        Statistics include the mean and standard deviation of each parameter, the naive standard error and Monte Carlo standard error (which measure uncertainty in the mean), the effective sample size, $\hat{R}$ diagnostic, and effective samples per second, which describes sampling speed.
        In general, a $\hat{R}$ value close to one is consistent with, though does not guarantee, convergence.
    }\label{tab:surge-posterior-mcmc-diagnostics}
    \input{../../plots/surge-posterior-mcmc-diagnostics.tex}
\end{table}

\begin{table}[h]
    \centering
    \caption{As \cref{tab:surge-posterior-mcmc-diagnostics} but for draws from the prior distribution.}\label{tab:surge-prior-mcmc-diagnostics}
    \input{../../plots/surge-prior-mcmc-diagnostics.tex}
\end{table}

\end{document}
